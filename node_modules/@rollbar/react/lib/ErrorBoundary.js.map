{"version":3,"file":"ErrorBoundary.js","sources":["../src/error-boundary.js"],"sourcesContent":["'use client';\n\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport invariant from 'tiny-invariant';\nimport { LEVEL_ERROR } from './constants';\nimport { Context, getRollbarFromContext } from './provider';\nimport * as utils from './utils';\n\nconst INITIAL_ERROR_STATE = { hasError: false, error: null };\n\nexport class ErrorBoundary extends Component {\n  static contextType = Context;\n\n  static propTypes = {\n    fallbackUI: PropTypes.elementType,\n    errorMessage: PropTypes.oneOfType([PropTypes.string, PropTypes.func]),\n    extra: PropTypes.oneOfType([PropTypes.object, PropTypes.func]),\n    level: PropTypes.oneOfType([PropTypes.string, PropTypes.func]),\n    callback: PropTypes.func,\n    children: PropTypes.node,\n  };\n\n  static defaultProps = {\n    level: LEVEL_ERROR,\n  };\n\n  constructor(props) {\n    super(props);\n    invariant(\n      utils.isValidLevel(props.level),\n      `${props.level} is not a valid level setting for Rollbar`,\n    );\n    this.state = { ...INITIAL_ERROR_STATE };\n  }\n\n  static getDerivedStateFromError(error) {\n    return { hasError: true, error };\n  }\n\n  componentDidCatch(error, info) {\n    const { errorMessage, extra, level: targetLevel, callback } = this.props;\n    const custom = utils.value(extra, {}, error, info);\n    const data = { ...info, ...custom };\n    const level = utils.value(targetLevel, LEVEL_ERROR, error, info);\n    const rollbar = getRollbarFromContext(this.context);\n    if (!errorMessage) {\n      rollbar[level](error, data, callback);\n    } else {\n      let logMessage = utils.value(errorMessage, '', error, info);\n      rollbar[level](logMessage, error, data, callback);\n    }\n  }\n\n  resetError = () => {\n    this.setState(INITIAL_ERROR_STATE);\n  };\n\n  render() {\n    const { hasError, error } = this.state;\n    const { fallbackUI: FallbackUI, children } = this.props;\n\n    if (!hasError) {\n      return children;\n    }\n\n    if (!FallbackUI) {\n      return null;\n    }\n\n    return <FallbackUI error={error} resetError={this.resetError} />;\n  }\n}\n"],"names":["hasError","error","ErrorBoundary","_classCallCheck","_this","_defineProperty","invariant","_createClass","value","errorMessage","extra","level"],"mappings":";;;;;;;;;;;AASA;AAA8BA;AAAiBC;AAAY;AAE9CC;;;AAgBQ;AAAAC;AACjBC;AAAaC;AA2BbD;;AA1BAE;AAIAF;AAAwC;AAC1C;AAACG;;AAAAC;AAOC;;;;;AACA;;AAEA;AACA;;;AAGA;AACE;;AAEF;AACF;AAAC;;;AAOC;;;AACA;;;;AAGE;AACF;;AAGE;AACF;AAEA;AAAmBP;;AAA0C;AAC/D;AAAC;;AAAAO;;AAlCUR;AAAgBC;;AAC3B;AAAC;AAAA;AAAA;AAkCFI;AA5D6BA;;AAI1BI;AACAC;AACAC;;;AAGF;AAACN;AAGCM;AACF;;"}