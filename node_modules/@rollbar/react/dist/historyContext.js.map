{"version":3,"file":"historyContext.js","sources":["../src/history-context.js"],"sourcesContent":["import Rollbar from 'rollbar';\nimport invariant from 'tiny-invariant';\n\nexport function historyContext(rollbar, { formatter, filter } = {}) {\n  invariant(\n    rollbar instanceof Rollbar,\n    'historyContext must have an instance of Rollbar',\n  );\n  invariant(\n    formatter == null || typeof formatter === 'function',\n    `formatter option must be a function, received ${typeof formatter} instead`,\n  );\n  invariant(\n    filter == null || typeof filter === 'function',\n    `filter option must be a function, received ${typeof filter} instead`,\n  );\n  // v4 of history.listen callback signature is (location, action)\n  // v5 of history.listen callback signature is ({ location, action })\n  // this implementation translates it to work for both\n  return (v4location, v4action) => {\n    let { action, location } = v4location;\n    if (v4action) {\n      action = v4action;\n      location = v4location;\n    }\n    if (filter && !filter(location, action)) {\n      return;\n    }\n    const context = formatter ? formatter(location, action) : location.pathname;\n    invariant(\n      typeof context === 'string',\n      'formatter must return a string value to set the context',\n    );\n    rollbar.configure({ payload: { context } });\n  };\n}\n"],"names":["historyContext","rollbar","_ref","arguments","length","undefined","formatter","filter","invariant","Rollbar","concat","_typeof","v4location","v4action","action","location","context","pathname","configure","payload"],"mappings":";;;;AAGO,SAASA,cAAcA,CAACC,OAAO,EAA8B;AAAA,EAAA,IAAAC,IAAA,GAAAC,SAAA,CAAAC,MAAA,GAAA,CAAA,IAAAD,SAAA,CAAA,CAAA,CAAA,KAAAE,SAAA,GAAAF,SAAA,CAAA,CAAA,CAAA,GAAJ,EAAE;IAAxBG,SAAS,GAAAJ,IAAA,CAATI,SAAS;IAAEC,MAAM,GAAAL,IAAA,CAANK,MAAM,CAAA;AACzDC,EAAAA,SAAS,CACPP,OAAO,YAAYQ,OAAO,EAC1B,iDACF,CAAC,CAAA;AACDD,EAAAA,SAAS,CACPF,SAAS,IAAI,IAAI,IAAI,OAAOA,SAAS,KAAK,UAAU,EAAA,gDAAA,CAAAI,MAAA,CAAAC,OAAA,CACIL,SAAS,cACnE,CAAC,CAAA;AACDE,EAAAA,SAAS,CACPD,MAAM,IAAI,IAAI,IAAI,OAAOA,MAAM,KAAK,UAAU,EAAA,6CAAA,CAAAG,MAAA,CAAAC,OAAA,CACOJ,MAAM,cAC7D,CAAC,CAAA;AACD;AACA;AACA;AACA,EAAA,OAAO,UAACK,UAAU,EAAEC,QAAQ,EAAK;AAC/B,IAAA,IAAMC,MAAM,GAAeF,UAAU,CAA/BE,MAAM;MAAEC,QAAQ,GAAKH,UAAU,CAAvBG,QAAQ,CAAA;AACtB,IAAA,IAAIF,QAAQ,EAAE;AACZC,MAAAA,MAAM,GAAGD,QAAQ,CAAA;AACjBE,MAAAA,QAAQ,GAAGH,UAAU,CAAA;AACvB,KAAA;IACA,IAAIL,MAAM,IAAI,CAACA,MAAM,CAACQ,QAAQ,EAAED,MAAM,CAAC,EAAE;AACvC,MAAA,OAAA;AACF,KAAA;AACA,IAAA,IAAME,OAAO,GAAGV,SAAS,GAAGA,SAAS,CAACS,QAAQ,EAAED,MAAM,CAAC,GAAGC,QAAQ,CAACE,QAAQ,CAAA;AAC3ET,IAAAA,SAAS,CACP,OAAOQ,OAAO,KAAK,QAAQ,EAC3B,yDACF,CAAC,CAAA;IACDf,OAAO,CAACiB,SAAS,CAAC;AAAEC,MAAAA,OAAO,EAAE;AAAEH,QAAAA,OAAO,EAAPA,OAAAA;AAAQ,OAAA;AAAE,KAAC,CAAC,CAAA;GAC5C,CAAA;AACH;;;;"}